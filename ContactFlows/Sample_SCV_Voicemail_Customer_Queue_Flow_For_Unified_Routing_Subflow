{"Version":"2019-10-30","StartAction":"Waiting loop","Metadata":{"entryPointPosition":{"x":-172.8,"y":121.6},"ActionMetadata":{"c3ba570b-70ae-4e02-9f6e-f5ac32c632e2":{"position":{"x":1608,"y":-14.4},"parameters":{"Attributes":{"vm_from":{"useDynamic":true},"vm_queue_arn":{"useDynamic":true},"vm_queue_name":{"useDynamic":true}}},"dynamicParams":["vm_from","vm_queue_arn","vm_queue_name"]},"ebf9f9d5-9fc2-4b30-8c50-e5b63dc0762a":{"position":{"x":1868.8,"y":-13.6}},"3a0350ff-62c8-4302-ba4c-64dd137178ac":{"position":{"x":2132,"y":-15.2},"conditionMetadata":[]},"8e8b1f66-f6bc-48de-ab7d-6decff31d131":{"position":{"x":2437.6,"y":-12.8}},"19755545-3e36-48fb-b6ba-09a6f938aff5":{"position":{"x":1608.8,"y":304.8}},"eb75b90e-f595-4049-8ee8-723fc620e55c":{"position":{"x":2693.6,"y":-12.8}},"f6fe08e3-2044-4055-b08c-b49aa93dd1dd":{"position":{"x":2929.6,"y":288.8}},"Resume the waiting loop":{"position":{"x":622.4,"y":539.2},"isFriendlyName":true},"7ff81687-3843-45fc-b941-91ec2aa90fc2":{"position":{"x":1092,"y":302.4}},"189e0eca-e8ff-446d-b58e-b5dc137fef8a":{"position":{"x":1331.2,"y":6.4},"toCustomer":false,"fromCustomer":true},"9b0e404c-1195-47fd-8dff-a27dada2c516":{"position":{"x":1091.2,"y":15.2}},"Cancel routing":{"position":{"x":612.8,"y":22.4},"isFriendlyName":true,"parameters":{"LambdaFunctionARN":{"displayName":"LocalContactCenter-InvokeTelephonyIntegrationApiFunction:active"}},"dynamicMetadata":{"flowInput-recordId":false,"fallbackQueue":false,"flowDevName":false,"methodName":false,"flowInput-IncomingCallPhoneNumber":false}},"2cbf6dc6-2278-454d-b09e-171fe1de7ce1":{"position":{"x":858.4,"y":12}},"Waiting loop":{"position":{"x":12.8,"y":25.6},"isFriendlyName":true,"parameters":{"Messages":[null,{"PromptId":{"displayName":"CustomerQueue.wav"}}],"InterruptFrequencySeconds":{"unit":60}},"audio":[{"id":"arn:aws:connect:us-west-2:133179445322:instance/2f71ff24-8ae9-47c4-8abd-1386e664ecd3/prompt/9d5198ed-fa1b-42a7-a78d-67a2f770ac01","text":"CustomerQueue.wav","type":"Prompt"}],"timeoutUnit":{"value":"min"}},"0adc6a21-ca79-426d-a9f8-f0b6595ca4c3":{"position":{"x":296,"y":12.8},"conditionMetadata":[{"id":"9ad9a887-33e6-4d39-bf2c-3a0b26b25247","value":"1"},{"id":"489403ec-4507-4c55-bd44-e8738f8be9ca","value":"2"}]},"6eb774d4-d208-46c8-9757-2b7d52944330":{"position":{"x":268,"y":470.4}}},"Annotations":[],"name":"Sample SCV Voicemail Customer Queue Flow For Unified Routing Subflow","description":"","type":"customerQueue","status":"SAVED","hash":{}},"Actions":[{"Parameters":{"Attributes":{"vm_from":"$.CustomerEndpoint.Address","vm_lang":"en-US","vm_queue_arn":"$.Queue.ARN","vm_flag":"1","vm_queue_name":"$.Queue.Name"},"TargetContact":"Current"},"Identifier":"c3ba570b-70ae-4e02-9f6e-f5ac32c632e2","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ebf9f9d5-9fc2-4b30-8c50-e5b63dc0762a","Errors":[{"NextAction":"19755545-3e36-48fb-b6ba-09a6f938aff5","ErrorType":"NoMatchingError"}]}},{"Parameters":{"SSML":"<speak><say-as interpret-as=\"expletive\">beep</say-as></speak>"},"Identifier":"ebf9f9d5-9fc2-4b30-8c50-e5b63dc0762a","Type":"MessageParticipant","Transitions":{"NextAction":"3a0350ff-62c8-4302-ba4c-64dd137178ac","Errors":[{"NextAction":"19755545-3e36-48fb-b6ba-09a6f938aff5","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"60","SSML":"<speak><break time=\"5s\"/></speak>"},"Identifier":"3a0350ff-62c8-4302-ba4c-64dd137178ac","Type":"GetParticipantInput","Transitions":{"NextAction":"8e8b1f66-f6bc-48de-ab7d-6decff31d131","Errors":[{"NextAction":"8e8b1f66-f6bc-48de-ab7d-6decff31d131","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"8e8b1f66-f6bc-48de-ab7d-6decff31d131","ErrorType":"NoMatchingCondition"},{"NextAction":"8e8b1f66-f6bc-48de-ab7d-6decff31d131","ErrorType":"NoMatchingError"}]}},{"Parameters":{"MediaStreamingState":"Disabled","Participants":[{"ParticipantType":"Customer","MediaDirections":["To","From"]}],"MediaStreamType":"Audio"},"Identifier":"8e8b1f66-f6bc-48de-ab7d-6decff31d131","Type":"UpdateContactMediaStreamingBehavior","Transitions":{"NextAction":"eb75b90e-f595-4049-8ee8-723fc620e55c","Errors":[{"NextAction":"eb75b90e-f595-4049-8ee8-723fc620e55c","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Text":"Sorry, the voicemail system has encountered an error.Please try again later. We apologize for any inconvenience. Goodbye."},"Identifier":"19755545-3e36-48fb-b6ba-09a6f938aff5","Type":"MessageParticipant","Transitions":{"NextAction":"f6fe08e3-2044-4055-b08c-b49aa93dd1dd","Errors":[{"NextAction":"f6fe08e3-2044-4055-b08c-b49aa93dd1dd","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Text":"Your voicemail has been saved. Goodbye."},"Identifier":"eb75b90e-f595-4049-8ee8-723fc620e55c","Type":"MessageParticipant","Transitions":{"NextAction":"f6fe08e3-2044-4055-b08c-b49aa93dd1dd"}},{"Parameters":{},"Identifier":"f6fe08e3-2044-4055-b08c-b49aa93dd1dd","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{},"Identifier":"Resume the waiting loop","Type":"EndFlowExecution","Transitions":{}},{"Parameters":{"Text":"The voicemail system has encountered an error. We are placing you in queue."},"Identifier":"7ff81687-3843-45fc-b941-91ec2aa90fc2","Type":"MessageParticipant","Transitions":{"NextAction":"Resume the waiting loop"}},{"Parameters":{"MediaStreamingState":"Enabled","MediaStreamType":"Audio","Participants":[{"ParticipantType":"Customer","MediaDirections":["From"]}]},"Identifier":"189e0eca-e8ff-446d-b58e-b5dc137fef8a","Type":"UpdateContactMediaStreamingBehavior","Transitions":{"NextAction":"c3ba570b-70ae-4e02-9f6e-f5ac32c632e2","Errors":[{"NextAction":"19755545-3e36-48fb-b6ba-09a6f938aff5","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Text":"We will begin to record your message after the tone. When finished, you may hang up. Your voicemail will be saved and delivered to a representative."},"Identifier":"9b0e404c-1195-47fd-8dff-a27dada2c516","Type":"MessageParticipant","Transitions":{"NextAction":"189e0eca-e8ff-446d-b58e-b5dc137fef8a"}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:133179445322:function:LocalContactCenter-InvokeTelephonyIntegrationApiFunction:active","InvocationTimeLimitSeconds":"8","LambdaInvocationAttributes":{"flowInput-recordId":"$.Attributes.voiceCallId","fallbackQueue":"SCV_BASIC_QUEUE","flowDevName":"SCV_Basic_Routing_Flow_Edited","methodName":"cancelOmniFlowExecution","flowInput-IncomingCallPhoneNumber":"$.CustomerEndpoint.Address"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"Cancel routing","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"2cbf6dc6-2278-454d-b09e-171fe1de7ce1","Errors":[{"NextAction":"7ff81687-3843-45fc-b941-91ec2aa90fc2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"FlowLoggingBehavior":"Enabled"},"Identifier":"2cbf6dc6-2278-454d-b09e-171fe1de7ce1","Type":"UpdateFlowLoggingBehavior","Transitions":{"NextAction":"9b0e404c-1195-47fd-8dff-a27dada2c516"}},{"Parameters":{"InterruptFrequencySeconds":"120","Messages":[{"Text":"Kindly wait in line for the agent to become available."},{"PromptId":"arn:aws:connect:us-west-2:133179445322:instance/2f71ff24-8ae9-47c4-8abd-1386e664ecd3/prompt/9d5198ed-fa1b-42a7-a78d-67a2f770ac01"}]},"Identifier":"Waiting loop","Type":"MessageParticipantIteratively","Transitions":{"NextAction":"6eb774d4-d208-46c8-9757-2b7d52944330","Conditions":[{"NextAction":"0adc6a21-ca79-426d-a9f8-f0b6595ca4c3","Condition":{"Operator":"Equals","Operands":["MessagesInterrupted"]}}],"Errors":[{"NextAction":"6eb774d4-d208-46c8-9757-2b7d52944330","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Text":"Your have been waiting in line for more than 2 minutes. \nPress 1 or stay on the phone to wait. \nPress 2 to record voicemail.","StoreInput":"False","InputTimeLimitSeconds":"5"},"Identifier":"0adc6a21-ca79-426d-a9f8-f0b6595ca4c3","Type":"GetParticipantInput","Transitions":{"NextAction":"Resume the waiting loop","Conditions":[{"NextAction":"Resume the waiting loop","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"Cancel routing","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"Resume the waiting loop","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"Resume the waiting loop","ErrorType":"NoMatchingCondition"},{"NextAction":"6eb774d4-d208-46c8-9757-2b7d52944330","ErrorType":"NoMatchingError"}]}},{"Parameters":{},"Identifier":"6eb774d4-d208-46c8-9757-2b7d52944330","Type":"DisconnectParticipant","Transitions":{}}]}