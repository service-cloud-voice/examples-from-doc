{
  "modules": [
    {
      "id": "5197ed08-9111-4336-9681-ad41f218c5f0",
      "type": "SetCallBackNumber",
      "branches": [
        {
          "condition": "Success",
          "transition": "754960f8-b7e8-488c-9d54-f01bd60083c4"
        },
        {
          "condition": "InvalidPhoneNumber",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        },
        {
          "condition": "NonDialableNumber",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        }
      ],
      "parameters": [
        {
          "name": "CallBackNumber",
          "value": "Stored customer input",
          "namespace": "System"
        }
      ],
      "metadata": {
        "position": {
          "x": 2319,
          "y": 419
        }
      }
    },
    {
      "id": "6222f537-3eb7-461b-9def-6be4f01ed693",
      "type": "PlayPrompt",
      "branches": [
        {
          "condition": "Success",
          "transition": "92074f0b-1d5c-4c9c-91e3-123fbacd4286"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "There is a problem with the phone number you entered. Please try again.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 2047,
          "y": 730
        },
        "useDynamic": false
      }
    },
    {
      "id": "458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9",
      "type": "PlayPrompt",
      "branches": [
        {
          "condition": "Success",
          "transition": "41bfd902-b5e2-48db-9f0e-a2445665407d"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "An agent will call you back at your requested phone number. Goodbye.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 2859,
          "y": 413
        },
        "useDynamic": false
      }
    },
    {
      "id": "41bfd902-b5e2-48db-9f0e-a2445665407d",
      "type": "Disconnect",
      "branches": [],
      "parameters": [],
      "metadata": {
        "position": {
          "x": 3907,
          "y": 244
        }
      }
    },
    {
      "id": "2143f91e-d2fb-4d86-a00a-a678028a8113",
      "type": "SetRecordingBehavior",
      "branches": [
        {
          "condition": "Success",
          "transition": "1ed06f98-cc32-40c1-ae0c-b6301ab6e543"
        }
      ],
      "parameters": [
        {
          "name": "RecordingBehaviorOption",
          "value": "Enable"
        },
        {
          "name": "RecordingParticipantOption",
          "value": "Both"
        }
      ],
      "metadata": {
        "position": {
          "x": 2824,
          "y": 14
        }
      }
    },
    {
      "id": "031339a0-bdd4-46a0-9c22-188c86fe9b00",
      "type": "InvokeExternalResource",
      "branches": [
        {
          "condition": "Success",
          "transition": "895d32b4-cc3b-4454-88d3-edd237d8856e"
        },
        {
          "condition": "Error",
          "transition": "1e829348-68f1-4d5d-a29d-571ff5a92b6b"
        }
      ],
      "parameters": [
        {
          "name": "FunctionArn",
          "value": "arn:aws:lambda:us-west-2:403503132786:function:MigrationTestCC-InvokeTelephonyIntegrationApiFunction:active",
          "namespace": null
        },
        {
          "name": "TimeLimit",
          "value": "8"
        },
        {
          "name": "Parameter",
          "key": "methodName",
          "value": "createVoiceCall",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 1235,
          "y": 17
        },
        "dynamicMetadata": {
          "methodName": false
        },
        "useDynamic": false
      },
      "target": "Lambda"
    },
    {
      "id": "1ed06f98-cc32-40c1-ae0c-b6301ab6e543",
      "type": "SetEventHook",
      "branches": [
        {
          "condition": "Success",
          "transition": "d209b58e-4646-4b4e-b1ed-46aba7803c8e"
        },
        {
          "condition": "Error",
          "transition": "743de69e-1f2a-46ed-81e5-0641e648547a"
        }
      ],
      "parameters": [
        {
          "name": "Type",
          "value": "AgentWhisper"
        },
        {
          "name": "ContactFlowId",
          "value": "beb5f40c-aee7-485e-8923-7725ce3a34d9",
          "resourceName": "Sample SCV Agent Whisper With Transcription"
        }
      ],
      "metadata": {
        "position": {
          "x": 3097,
          "y": 16
        },
        "contactFlow": {
          "id": "beb5f40c-aee7-485e-8923-7725ce3a34d9",
          "text": "Sample SCV Agent Whisper With Transcription"
        },
        "customerOrAgent": false,
        "useDynamic": false
      }
    },
    {
      "id": "743de69e-1f2a-46ed-81e5-0641e648547a",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "d209b58e-4646-4b4e-b1ed-46aba7803c8e"
        },
        {
          "condition": "Error",
          "transition": "d209b58e-4646-4b4e-b1ed-46aba7803c8e"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "false",
          "key": "isTranscribed",
          "namespace": null
        },
        {
          "name": "Attribute",
          "value": "Failed to set agent whisper flow.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 3099,
          "y": 258
        },
        "dynamicParams": []
      }
    },
    {
      "id": "46b57ed3-fc96-49ff-b54c-840db344a958",
      "type": "PlayPrompt",
      "branches": [
        {
          "condition": "Success",
          "transition": "41bfd902-b5e2-48db-9f0e-a2445665407d"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "We are experiencing a higher than normal volume of calls and cannot currently assist you. Please try again later. We apologize for any inconvenience. Goodbye.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 3900,
          "y": 16
        },
        "useDynamic": false
      }
    },
    {
      "id": "0967364c-0fff-403a-812f-106d60881048",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "46b57ed3-fc96-49ff-b54c-840db344a958"
        },
        {
          "condition": "Error",
          "transition": "46b57ed3-fc96-49ff-b54c-840db344a958"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Queue capacity limit exceeded.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 3635,
          "y": 17
        },
        "dynamicParams": []
      }
    },
    {
      "id": "754960f8-b7e8-488c-9d54-f01bd60083c4",
      "type": "CreateCallback",
      "branches": [
        {
          "condition": "Success",
          "transition": "458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9"
        },
        {
          "condition": "Error",
          "transition": "8872e909-b493-43ba-b592-7cc9e2cfa1b3"
        }
      ],
      "parameters": [
        {
          "name": "InitialDelaySeconds",
          "value": 60
        },
        {
          "name": "RetryDelaySeconds",
          "value": 600
        },
        {
          "name": "MaxRetryAttempts",
          "value": 2
        }
      ],
      "metadata": {
        "position": {
          "x": 2586,
          "y": 416
        },
        "useDynamic": false,
        "queue": null
      }
    },
    {
      "id": "d209b58e-4646-4b4e-b1ed-46aba7803c8e",
      "type": "Transfer",
      "branches": [
        {
          "condition": "AtCapacity",
          "transition": "0967364c-0fff-403a-812f-106d60881048"
        },
        {
          "condition": "Error",
          "transition": "8872e909-b493-43ba-b592-7cc9e2cfa1b3"
        }
      ],
      "parameters": [],
      "metadata": {
        "position": {
          "x": 3366,
          "y": 18
        },
        "useDynamic": false,
        "queue": null
      },
      "target": "Queue"
    },
    {
      "id": "8872e909-b493-43ba-b592-7cc9e2cfa1b3",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to transfer to queue.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 3645,
          "y": 348
        },
        "dynamicParams": []
      }
    },
    {
      "id": "5e054726-0d22-4212-b6f2-d1297973f7ec",
      "type": "PlayPrompt",
      "branches": [
        {
          "condition": "Success",
          "transition": "41bfd902-b5e2-48db-9f0e-a2445665407d"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "I'm sorry. We have encountered an error and cannot currently handle your call. Please try again later. We apologize for any inconvenience. Goodbye.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 3361,
          "y": 671
        },
        "useDynamic": false
      }
    },
    {
      "id": "6932dec4-7994-4e9b-b1a9-7558aaab8fcb",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "368636e5-8e1d-46cb-a342-8a27bf9cd1d6"
        },
        {
          "condition": "Error",
          "transition": "368636e5-8e1d-46cb-a342-8a27bf9cd1d6"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "4839de0c-a528-4e74-a12a-f98b8ec0f0e7",
          "key": "BasicQueueId",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 175,
          "y": 19
        },
        "dynamicParams": []
      }
    },
    {
      "id": "1e829348-68f1-4d5d-a29d-571ff5a92b6b",
      "type": "Loop",
      "branches": [
        {
          "condition": "Looping",
          "transition": "031339a0-bdd4-46a0-9c22-188c86fe9b00"
        },
        {
          "condition": "Complete",
          "transition": "43e43416-c441-4293-8f34-870c9caaf759"
        }
      ],
      "parameters": [
        {
          "name": "LoopCount",
          "value": "2"
        }
      ],
      "metadata": {
        "position": {
          "x": 962,
          "y": 17
        },
        "useDynamic": false
      }
    },
    {
      "id": "368636e5-8e1d-46cb-a342-8a27bf9cd1d6",
      "type": "SetLoggingBehavior",
      "branches": [
        {
          "condition": "Success",
          "transition": "44b07d2d-7661-4b29-b53d-8733b0175840"
        }
      ],
      "parameters": [
        {
          "name": "LoggingBehavior",
          "value": "Enable"
        }
      ],
      "metadata": {
        "position": {
          "x": 447,
          "y": 19
        }
      }
    },
    {
      "id": "44b07d2d-7661-4b29-b53d-8733b0175840",
      "type": "PlayPrompt",
      "branches": [
        {
          "condition": "Success",
          "transition": "1e829348-68f1-4d5d-a29d-571ff5a92b6b"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Thank you for calling Call Back Testing. Calls may be monitored for quality assurance.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 699,
          "y": 17
        },
        "useDynamic": false
      }
    },
    {
      "id": "92074f0b-1d5c-4c9c-91e3-123fbacd4286",
      "type": "StoreUserInput",
      "branches": [
        {
          "condition": "Success",
          "transition": "5197ed08-9111-4336-9681-ad41f218c5f0"
        },
        {
          "condition": "InvalidNumber",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        },
        {
          "condition": "Error",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Please enter the phone number you would like to be called back at."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        },
        {
          "name": "CustomerInputType",
          "value": "PhoneNumber"
        },
        {
          "name": "Timeout",
          "value": "5"
        },
        {
          "name": "PhoneNumberFormat",
          "value": "Local"
        },
        {
          "name": "CountryCode",
          "value": "US"
        }
      ],
      "metadata": {
        "position": {
          "x": 2058,
          "y": 422
        },
        "useDynamic": false,
        "useDynamicForEncryptionKeys": true,
        "useDynamicForTerminatorDigits": false,
        "countryCodePrefix": "+1"
      }
    },
    {
      "id": "34bfe065-d198-4068-8fb6-49e17034441f",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to get customer callback input.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 2602,
          "y": 970
        },
        "dynamicParams": []
      }
    },
    {
      "id": "13f49ac1-935b-439a-9f2e-cb6d0d2e3985",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to set working queue.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 1844,
          "y": 979
        },
        "dynamicParams": []
      }
    },
    {
      "id": "895d32b4-cc3b-4454-88d3-edd237d8856e",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        },
        {
          "condition": "Error",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "voiceCallId",
          "key": "voiceCallId",
          "namespace": "External"
        }
      ],
      "metadata": {
        "position": {
          "x": 1508,
          "y": 17
        },
        "dynamicParams": [
          "voiceCallId"
        ]
      }
    },
    {
      "id": "43e43416-c441-4293-8f34-870c9caaf759",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        },
        {
          "condition": "Error",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Dialed Number",
          "key": "sfdc-ToPhoneNumber",
          "namespace": "System"
        },
        {
          "name": "Attribute",
          "value": "VoiceCall record creation failed.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 962,
          "y": 269
        },
        "dynamicParams": [
          "sfdc-ToPhoneNumber"
        ]
      }
    },
    {
      "id": "44e68e33-9d16-4f64-82ed-40e5de5cf56d",
      "type": "GetUserInput",
      "branches": [
        {
          "condition": "Evaluate",
          "conditionType": "Equals",
          "conditionValue": "1",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        },
        {
          "condition": "Evaluate",
          "conditionType": "Equals",
          "conditionValue": "2",
          "transition": "92074f0b-1d5c-4c9c-91e3-123fbacd4286"
        },
        {
          "condition": "Timeout",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        },
        {
          "condition": "NoMatch",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        },
        {
          "condition": "Error",
          "transition": "34bfe065-d198-4068-8fb6-49e17034441f"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Your wait time to speak with an agent is greater than 1 minutes. Press 1 or stay on the phone to wait. Press 2 to receive a callback when it is your turn.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        },
        {
          "name": "Timeout",
          "value": "5"
        },
        {
          "name": "MaxDigits",
          "value": "1"
        }
      ],
      "metadata": {
        "position": {
          "x": 2311,
          "y": 16
        },
        "conditionMetadata": [
          {
            "id": "6d99f93f-9b9b-4169-9e80-28a213cb1cce",
            "value": "1"
          },
          {
            "id": "dc32a122-bafa-43ae-81f5-64ee7d784adb",
            "value": "2"
          }
        ],
        "useDynamic": false,
        "useLexBotDropdown": true,
        "useDynamicLexBotArn": false,
        "lexV2BotName": null
      },
      "target": "Digits"
    },
    {
      "id": "2d4ba17d-a65c-4195-88c2-13922cb8e370",
      "type": "PlayPrompt",
      "branches": [
        {
          "condition": "Success",
          "transition": "2143f91e-d2fb-4d86-a00a-a678028a8113"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Transferring to customer support.",
          "namespace": null
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 2563,
          "y": 17
        },
        "useDynamic": false
      }
    },
    {
      "id": "45edb1bf-8b4d-40e3-a9f1-85c75f106419",
      "type": "SetAttributes",
      "branches": [
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to check queue status.",
          "key": "error",
          "namespace": null
        }
      ],
      "metadata": {
        "position": {
          "x": 2289,
          "y": 969
        },
        "dynamicParams": []
      }
    },
    {
      "id": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2",
      "type": "SetQueue",
      "branches": [
        {
          "condition": "Success",
          "transition": "7910d7ee-d150-40d0-9f90-b4ab56b1e4ec"
        },
        {
          "condition": "Error",
          "transition": "13f49ac1-935b-439a-9f2e-cb6d0d2e3985"
        }
      ],
      "parameters": [
        {
          "name": "Queue",
          "value": "arn:aws:connect:us-west-2:403503132786:instance/d907a405-bf4e-4802-9738-f27d67bb12e9/queue/4839de0c-a528-4e74-a12a-f98b8ec0f0e7",
          "namespace": null,
          "resourceName": "BasicQueue"
        }
      ],
      "metadata": {
        "position": {
          "x": 1792,
          "y": 14
        },
        "useDynamic": false,
        "queue": {
          "id": "arn:aws:connect:us-west-2:403503132786:instance/d907a405-bf4e-4802-9738-f27d67bb12e9/queue/4839de0c-a528-4e74-a12a-f98b8ec0f0e7",
          "text": "BasicQueue"
        }
      }
    },
    {
      "id": "7910d7ee-d150-40d0-9f90-b4ab56b1e4ec",
      "type": "CheckQueueStatus",
      "branches": [
        {
          "condition": "CheckQueueSize",
          "conditionType": "LessThanOrEqualTo",
          "conditionValue": 60000,
          "transition": "44e68e33-9d16-4f64-82ed-40e5de5cf56d"
        },
        {
          "condition": "NoMatch",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        },
        {
          "condition": "Error",
          "transition": "45edb1bf-8b4d-40e3-a9f1-85c75f106419"
        }
      ],
      "parameters": [],
      "metadata": {
        "position": {
          "x": 2058,
          "y": 15
        },
        "conditionMetadata": [
          {
            "attribute": {
              "name": "Queue capacity",
              "value": "Queue Capacity",
              "internalValue": "CheckQueueSize"
            },
            "time": "min.",
            "value": "1",
            "operator": {
              "name": "Is less or equal",
              "value": "LessThanOrEqualTo",
              "shortDisplay": "<="
            },
            "id": "c776812e-acd2-425e-895c-38d81aed055e"
          }
        ],
        "queue": null,
        "useDynamic": false
      }
    }
  ],
  "version": "1",
  "start": "6932dec4-7994-4e9b-b1a9-7558aaab8fcb",
  "metadata": {
    "entryPointPosition": {
      "x": 15,
      "y": 51.5
    },
    "snapToGrid": false,
    "name": "Sample SCV Inbound Flow With Transcription",
    "description": "Greets the caller and creates a Voice Call record. Provides a callback option when wait time exceeds five minutes. Sets Sample SCV Agent Whisper With Transcription flow to start transcription.",
    "type": "contactFlow",
    "status": "published",
    "hash": "42b749463c1d29c6fd9ca21e5a3a74ccd20fe6276e71fff9c3e96ae4dd1c5cd5"
  },
  "type": "contactFlow"
}