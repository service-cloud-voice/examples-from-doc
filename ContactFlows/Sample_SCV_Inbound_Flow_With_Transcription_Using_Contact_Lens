{"Version":"2019-10-30","StartAction":"6932dec4-7994-4e9b-b1a9-7558aaab8fcb","Metadata":{"entryPointPosition":{"x":15,"y":51.5},"snapToGrid":false,"ActionMetadata":{"5197ed08-9111-4336-9681-ad41f218c5f0":{"position":{"x":2319,"y":419}},"6222f537-3eb7-461b-9def-6be4f01ed693":{"position":{"x":2047,"y":730},"useDynamic":false},"458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9":{"position":{"x":2859,"y":413},"useDynamic":false},"41bfd902-b5e2-48db-9f0e-a2445665407d":{"position":{"x":3907,"y":244}},"92074f0b-1d5c-4c9c-91e3-123fbacd4286":{"position":{"x":2058,"y":422},"useDynamic":false,"useDynamicForEncryptionKeys":true,"useDynamicForTerminatorDigits":false,"countryCodePrefix":"+1"},"754960f8-b7e8-488c-9d54-f01bd60083c4":{"position":{"x":2586,"y":416},"useDynamic":false},"44e68e33-9d16-4f64-82ed-40e5de5cf56d":{"position":{"x":2311,"y":16},"conditionMetadata":[{"id":"e7ac9ceb-4974-4fc1-81e9-18b30ba17b3a","value":"1"},{"id":"5205b06e-198f-4733-bc2b-9178372649cf","value":"2"}],"useDynamic":false,"useDynamicLexBotArn":false},"34bfe065-d198-4068-8fb6-49e17034441f":{"position":{"x":2602,"y":970}},"45edb1bf-8b4d-40e3-a9f1-85c75f106419":{"position":{"x":2289,"y":969}},"5e054726-0d22-4212-b6f2-d1297973f7ec":{"position":{"x":3361,"y":671},"useDynamic":false},"44b07d2d-7661-4b29-b53d-8733b0175840":{"position":{"x":699,"y":17},"useDynamic":false},"368636e5-8e1d-46cb-a342-8a27bf9cd1d6":{"position":{"x":447,"y":19}},"6932dec4-7994-4e9b-b1a9-7558aaab8fcb":{"position":{"x":175,"y":19}},"7910d7ee-d150-40d0-9f90-b4ab56b1e4ec":{"position":{"x":2058,"y":15},"conditionMetadata":[{"attribute":{"name":"Time in Queue","value":"Time in Queue","internalValue":"CheckQueueTime"},"time":"min.","value":"5","operator":{"name":"Is greater than","value":"GreaterThan","shortDisplay":">"},"id":"8a92af46-b4ab-4324-a401-9e9f3c1a5763"}],"useDynamic":false},"13f49ac1-935b-439a-9f2e-cb6d0d2e3985":{"position":{"x":1844,"y":979}},"f9aecd5b-639d-44ad-8099-7db1e7bbd8f2":{"position":{"x":1792,"y":14},"useDynamic":true,"queue":"BasicQueueId"},"43e43416-c441-4293-8f34-870c9caaf759":{"position":{"x":962,"y":269}},"895d32b4-cc3b-4454-88d3-edd237d8856e":{"position":{"x":1508,"y":17}},"1e829348-68f1-4d5d-a29d-571ff5a92b6b":{"position":{"x":962,"y":17},"useDynamic":false},"031339a0-bdd4-46a0-9c22-188c86fe9b00":{"position":{"x":1235,"y":18},"dynamicMetadata":{"methodName":false},"useDynamic":false},"2d4ba17d-a65c-4195-88c2-13922cb8e370":{"position":{"x":2563,"y":17},"useDynamic":false},"8872e909-b493-43ba-b592-7cc9e2cfa1b3":{"position":{"x":3645,"y":348}},"2143f91e-d2fb-4d86-a00a-a678028a8113":{"position":{"x":2824,"y":14}},"46b57ed3-fc96-49ff-b54c-840db344a958":{"position":{"x":3900,"y":16},"useDynamic":false},"d209b58e-4646-4b4e-b1ed-46aba7803c8e":{"position":{"x":3206,"y":8},"useDynamic":false},"0967364c-0fff-403a-812f-106d60881048":{"position":{"x":3598,"y":4}}}},"Actions":[{"Identifier":"5197ed08-9111-4336-9681-ad41f218c5f0","Parameters":{"CallbackNumber":"$.StoredCustomerInput"},"Transitions":{"NextAction":"754960f8-b7e8-488c-9d54-f01bd60083c4","Errors":[{"NextAction":"6222f537-3eb7-461b-9def-6be4f01ed693","ErrorType":"InvalidCallbackNumber"},{"NextAction":"6222f537-3eb7-461b-9def-6be4f01ed693","ErrorType":"CallbackNumberNotDialable"}],"Conditions":[]},"Type":"UpdateContactCallbackNumber"},{"Identifier":"6222f537-3eb7-461b-9def-6be4f01ed693","Parameters":{"Text":"There is a problem with the phone number you entered. Please try again."},"Transitions":{"NextAction":"92074f0b-1d5c-4c9c-91e3-123fbacd4286","Errors":[],"Conditions":[]},"Type":"MessageParticipant"},{"Identifier":"458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9","Parameters":{"Text":"An agent will call you back at your requested phone number. Goodbye."},"Transitions":{"NextAction":"41bfd902-b5e2-48db-9f0e-a2445665407d","Errors":[],"Conditions":[]},"Type":"MessageParticipant"},{"Identifier":"41bfd902-b5e2-48db-9f0e-a2445665407d","Type":"DisconnectParticipant","Parameters":{},"Transitions":{}},{"Identifier":"92074f0b-1d5c-4c9c-91e3-123fbacd4286","Parameters":{"Text":"Please enter the phone number you would like to be called back at.","StoreInput":"True","InputTimeLimitSeconds":"5","InputValidation":{"PhoneNumberValidation":{"NumberFormat":"Local","CountryCode":"US"}}},"Transitions":{"NextAction":"5197ed08-9111-4336-9681-ad41f218c5f0","Errors":[{"NextAction":"6222f537-3eb7-461b-9def-6be4f01ed693","ErrorType":"NoMatchingError"},{"NextAction":"6222f537-3eb7-461b-9def-6be4f01ed693","ErrorType":"InvalidPhoneNumber"}],"Conditions":[]},"Type":"GetParticipantInput"},{"Identifier":"754960f8-b7e8-488c-9d54-f01bd60083c4","Parameters":{"InitialCallDelaySeconds":"60","MaximumConnectionAttempts":"2","RetryDelaySeconds":"600"},"Transitions":{"NextAction":"458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9","Errors":[{"NextAction":"8872e909-b493-43ba-b592-7cc9e2cfa1b3","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"CreateCallbackContact"},{"Identifier":"44e68e33-9d16-4f64-82ed-40e5de5cf56d","Parameters":{"Text":"Your wait time to speak with an agent is greater than 5 minutes. Press 1 or stay on the phone to wait. Press 2 to receive a callback when it is your turn.","StoreInput":"False","InputTimeLimitSeconds":"5"},"Transitions":{"NextAction":"2d4ba17d-a65c-4195-88c2-13922cb8e370","Errors":[{"NextAction":"34bfe065-d198-4068-8fb6-49e17034441f","ErrorType":"NoMatchingError"},{"NextAction":"2d4ba17d-a65c-4195-88c2-13922cb8e370","ErrorType":"NoMatchingCondition"},{"NextAction":"2d4ba17d-a65c-4195-88c2-13922cb8e370","ErrorType":"InputTimeLimitExceeded"}],"Conditions":[{"NextAction":"2d4ba17d-a65c-4195-88c2-13922cb8e370","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"92074f0b-1d5c-4c9c-91e3-123fbacd4286","Condition":{"Operator":"Equals","Operands":["2"]}}]},"Type":"GetParticipantInput"},{"Identifier":"34bfe065-d198-4068-8fb6-49e17034441f","Parameters":{"Attributes":{"error":"Failed to get customer callback input."}},"Transitions":{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","Errors":[{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"45edb1bf-8b4d-40e3-a9f1-85c75f106419","Parameters":{"Attributes":{"error":"Failed to check queue status."}},"Transitions":{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","Errors":[{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"5e054726-0d22-4212-b6f2-d1297973f7ec","Parameters":{"Text":"I'm sorry. We have encountered an error and cannot currently handle your call. Please try again later. We apologize for any inconvenience. Goodbye."},"Transitions":{"NextAction":"41bfd902-b5e2-48db-9f0e-a2445665407d","Errors":[],"Conditions":[]},"Type":"MessageParticipant"},{"Identifier":"44b07d2d-7661-4b29-b53d-8733b0175840","Parameters":{"Text":"Thank you for calling. Calls may be monitored for quality assurance."},"Transitions":{"NextAction":"1e829348-68f1-4d5d-a29d-571ff5a92b6b","Errors":[],"Conditions":[]},"Type":"MessageParticipant"},{"Identifier":"368636e5-8e1d-46cb-a342-8a27bf9cd1d6","Parameters":{"FlowLoggingBehavior":"Enabled"},"Transitions":{"NextAction":"44b07d2d-7661-4b29-b53d-8733b0175840","Errors":[],"Conditions":[]},"Type":"UpdateFlowLoggingBehavior"},{"Identifier":"6932dec4-7994-4e9b-b1a9-7558aaab8fcb","Parameters":{"Attributes":{"BasicQueueId":"b2d19451-f2b2-487f-82ec-b4080013529a"}},"Transitions":{"NextAction":"368636e5-8e1d-46cb-a342-8a27bf9cd1d6","Errors":[{"NextAction":"368636e5-8e1d-46cb-a342-8a27bf9cd1d6","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"7910d7ee-d150-40d0-9f90-b4ab56b1e4ec","Parameters":{"MetricType":"OldestContactInQueueAgeSeconds"},"Transitions":{"NextAction":"45edb1bf-8b4d-40e3-a9f1-85c75f106419","Errors":[{"NextAction":"2d4ba17d-a65c-4195-88c2-13922cb8e370","ErrorType":"NoMatchingCondition"},{"NextAction":"45edb1bf-8b4d-40e3-a9f1-85c75f106419","ErrorType":"NoMatchingError"}],"Conditions":[{"NextAction":"44e68e33-9d16-4f64-82ed-40e5de5cf56d","Condition":{"Operator":"NumberGreaterThan","Operands":["300000"]}}]},"Type":"CheckMetricData"},{"Identifier":"13f49ac1-935b-439a-9f2e-cb6d0d2e3985","Parameters":{"Attributes":{"error":"Failed to set working queue."}},"Transitions":{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","Errors":[{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"f9aecd5b-639d-44ad-8099-7db1e7bbd8f2","Parameters":{"QueueId":"$.Attributes.BasicQueueId"},"Transitions":{"NextAction":"7910d7ee-d150-40d0-9f90-b4ab56b1e4ec","Errors":[{"NextAction":"13f49ac1-935b-439a-9f2e-cb6d0d2e3985","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactTargetQueue"},{"Identifier":"43e43416-c441-4293-8f34-870c9caaf759","Parameters":{"Attributes":{"sfdc-ToPhoneNumber":"$.SystemEndpoint.Address","error":"VoiceCall record creation failed."}},"Transitions":{"NextAction":"f9aecd5b-639d-44ad-8099-7db1e7bbd8f2","Errors":[{"NextAction":"f9aecd5b-639d-44ad-8099-7db1e7bbd8f2","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"895d32b4-cc3b-4454-88d3-edd237d8856e","Parameters":{"Attributes":{"voiceCallId":"$.External.voiceCallId"}},"Transitions":{"NextAction":"f9aecd5b-639d-44ad-8099-7db1e7bbd8f2","Errors":[{"NextAction":"f9aecd5b-639d-44ad-8099-7db1e7bbd8f2","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"1e829348-68f1-4d5d-a29d-571ff5a92b6b","Parameters":{"LoopCount":"2"},"Transitions":{"NextAction":"43e43416-c441-4293-8f34-870c9caaf759","Errors":[],"Conditions":[{"NextAction":"43e43416-c441-4293-8f34-870c9caaf759","Condition":{"Operator":"Equals","Operands":["DoneLooping"]}},{"NextAction":"031339a0-bdd4-46a0-9c22-188c86fe9b00","Condition":{"Operator":"Equals","Operands":["ContinueLooping"]}}]},"Type":"Loop"},{"Identifier":"031339a0-bdd4-46a0-9c22-188c86fe9b00","Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:363378196299:function:HVCC-InvokeTelephonyIntegrationApiFunction:active","InvocationTimeLimitSeconds":"8","LambdaInvocationAttributes":{"methodName":"createVoiceCall"}},"Transitions":{"NextAction":"895d32b4-cc3b-4454-88d3-edd237d8856e","Errors":[{"NextAction":"1e829348-68f1-4d5d-a29d-571ff5a92b6b","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"InvokeLambdaFunction"},{"Identifier":"2d4ba17d-a65c-4195-88c2-13922cb8e370","Parameters":{"Text":"Transferring to customer support."},"Transitions":{"NextAction":"2143f91e-d2fb-4d86-a00a-a678028a8113","Errors":[],"Conditions":[]},"Type":"MessageParticipant"},{"Identifier":"8872e909-b493-43ba-b592-7cc9e2cfa1b3","Parameters":{"Attributes":{"error":"Failed to transfer to queue."}},"Transitions":{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","Errors":[{"NextAction":"5e054726-0d22-4212-b6f2-d1297973f7ec","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"},{"Identifier":"2143f91e-d2fb-4d86-a00a-a678028a8113","Parameters":{"RecordingBehavior":{"RecordedParticipants":["Agent","Customer"]},"AnalyticsBehavior":{"Enabled":"True","AnalyticsMode":"RealTime","AnalyticsLanguage":"en-US","AnalyticsRedactionBehavior":"Enabled","AnalyticsRedactionResults":"RedactedAndOriginal"}},"Transitions":{"NextAction":"d209b58e-4646-4b4e-b1ed-46aba7803c8e","Errors":[],"Conditions":[]},"Type":"UpdateContactRecordingBehavior"},{"Identifier":"46b57ed3-fc96-49ff-b54c-840db344a958","Parameters":{"Text":"We are experiencing a higher than normal volume of calls and cannot currently assist you. Please try again later. We apologize for any inconvenience. Goodbye."},"Transitions":{"NextAction":"41bfd902-b5e2-48db-9f0e-a2445665407d","Errors":[],"Conditions":[]},"Type":"MessageParticipant"},{"Identifier":"d209b58e-4646-4b4e-b1ed-46aba7803c8e","Transitions":{"NextAction":"8872e909-b493-43ba-b592-7cc9e2cfa1b3","Errors":[{"NextAction":"8872e909-b493-43ba-b592-7cc9e2cfa1b3","ErrorType":"NoMatchingError"},{"NextAction":"0967364c-0fff-403a-812f-106d60881048","ErrorType":"QueueAtCapacity"}],"Conditions":[]},"Type":"TransferContactToQueue"},{"Identifier":"0967364c-0fff-403a-812f-106d60881048","Parameters":{"Attributes":{"error":"Queue capacity limit exceeded."}},"Transitions":{"NextAction":"46b57ed3-fc96-49ff-b54c-840db344a958","Errors":[{"NextAction":"46b57ed3-fc96-49ff-b54c-840db344a958","ErrorType":"NoMatchingError"}],"Conditions":[]},"Type":"UpdateContactAttributes"}]}
