{
  "start": "6932dec4-7994-4e9b-b1a9-7558aaab8fcb",
  "version": "1",
  "modules": [
    {
      "id": "5197ed08-9111-4336-9681-ad41f218c5f0",
      "branches": [
        {
          "condition": "InvalidPhoneNumber",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        },
        {
          "condition": "NonDialableNumber",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        },
        {
          "condition": "Success",
          "transition": "754960f8-b7e8-488c-9d54-f01bd60083c4"
        }
      ],
      "parameters": [
        {
          "name": "CallBackNumber",
          "value": "Stored customer input",
          "namespace": "System"
        }
      ],
      "metadata": {
        "position": {
          "x": 2319,
          "y": 419
        }
      },
      "type": "SetCallBackNumber"
    },
    {
      "id": "6222f537-3eb7-461b-9def-6be4f01ed693",
      "branches": [
        {
          "condition": "Success",
          "transition": "92074f0b-1d5c-4c9c-91e3-123fbacd4286"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "There is a problem with the phone number you entered. Please try again."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 2047,
          "y": 730
        },
        "useDynamic": false
      },
      "type": "PlayPrompt"
    },
    {
      "id": "458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9",
      "branches": [
        {
          "condition": "Success",
          "transition": "41bfd902-b5e2-48db-9f0e-a2445665407d"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "An agent will call you back at your requested phone number. Goodbye."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 2859,
          "y": 413
        },
        "useDynamic": false
      },
      "type": "PlayPrompt"
    },
    {
      "id": "41bfd902-b5e2-48db-9f0e-a2445665407d",
      "branches": [],
      "parameters": [],
      "metadata": {
        "position": {
          "x": 3907,
          "y": 244
        }
      },
      "type": "Disconnect"
    },
    {
      "id": "92074f0b-1d5c-4c9c-91e3-123fbacd4286",
      "branches": [
        {
          "condition": "Error",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        },
        {
          "condition": "InvalidNumber",
          "transition": "6222f537-3eb7-461b-9def-6be4f01ed693"
        },
        {
          "condition": "Success",
          "transition": "5197ed08-9111-4336-9681-ad41f218c5f0"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Please enter the phone number you would like to be called back at."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        },
        {
          "name": "CustomerInputType",
          "value": "PhoneNumber"
        },
        {
          "name": "PhoneNumberFormat",
          "value": "Local"
        },
        {
          "name": "CountryCode",
          "value": "US"
        },
        {
          "name": "Timeout",
          "value": "5"
        }
      ],
      "metadata": {
        "position": {
          "x": 2058,
          "y": 422
        },
        "useDynamic": false,
        "useDynamicForEncryptionKeys": true,
        "useDynamicForTerminatorDigits": false,
        "countryCodePrefix": "+1"
      },
      "type": "StoreUserInput"
    },
    {
      "id": "754960f8-b7e8-488c-9d54-f01bd60083c4",
      "branches": [
        {
          "condition": "Error",
          "transition": "8872e909-b493-43ba-b592-7cc9e2cfa1b3"
        },
        {
          "condition": "Success",
          "transition": "458aaf9d-62a8-40b2-b68c-4b38a8ce9fe9"
        }
      ],
      "parameters": [
        {
          "name": "InitialDelaySeconds",
          "value": "60"
        },
        {
          "name": "MaxRetryAttempts",
          "value": "2"
        },
        {
          "name": "RetryDelaySeconds",
          "value": "600"
        }
      ],
      "metadata": {
        "position": {
          "x": 2586,
          "y": 416
        },
        "useDynamic": false
      },
      "type": "CreateCallback"
    },
    {
      "id": "44e68e33-9d16-4f64-82ed-40e5de5cf56d",
      "branches": [
        {
          "condition": "Error",
          "transition": "34bfe065-d198-4068-8fb6-49e17034441f"
        },
        {
          "condition": "Timeout",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        },
        {
          "condition": "Evaluate",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370",
          "conditionType": "Equals",
          "conditionValue": "1"
        },
        {
          "condition": "Evaluate",
          "transition": "92074f0b-1d5c-4c9c-91e3-123fbacd4286",
          "conditionType": "Equals",
          "conditionValue": "2"
        },
        {
          "condition": "NoMatch",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Your wait time to speak with an agent is greater than 5 minutes. Press 1 or stay on the phone to wait. Press 2 to receive a callback when it is your turn."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        },
        {
          "name": "MaxDigits",
          "value": "1"
        },
        {
          "name": "Timeout",
          "value": "5"
        }
      ],
      "metadata": {
        "position": {
          "x": 2311,
          "y": 16
        },
        "conditionMetadata": [
          {
            "id": "e7ac9ceb-4974-4fc1-81e9-18b30ba17b3a",
            "value": "1"
          },
          {
            "id": "5205b06e-198f-4733-bc2b-9178372649cf",
            "value": "2"
          }
        ],
        "useDynamic": false,
        "useDynamicLexBotArn": false
      },
      "target": "Digits",
      "type": "GetUserInput"
    },
    {
      "id": "34bfe065-d198-4068-8fb6-49e17034441f",
      "branches": [
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to get customer callback input.",
          "key": "error"
        }
      ],
      "metadata": {
        "position": {
          "x": 2602,
          "y": 970
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "45edb1bf-8b4d-40e3-a9f1-85c75f106419",
      "branches": [
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to check queue status.",
          "key": "error"
        }
      ],
      "metadata": {
        "position": {
          "x": 2289,
          "y": 969
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "5e054726-0d22-4212-b6f2-d1297973f7ec",
      "branches": [
        {
          "condition": "Success",
          "transition": "41bfd902-b5e2-48db-9f0e-a2445665407d"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "I'm sorry. We have encountered an error and cannot currently handle your call. Please try again later. We apologize for any inconvenience. Goodbye."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 3361,
          "y": 671
        },
        "useDynamic": false
      },
      "type": "PlayPrompt"
    },
    {
      "id": "44b07d2d-7661-4b29-b53d-8733b0175840",
      "branches": [
        {
          "condition": "Success",
          "transition": "1e829348-68f1-4d5d-a29d-571ff5a92b6b"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Thank you for calling. Calls may be monitored for quality assurance."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 699,
          "y": 17
        },
        "useDynamic": false
      },
      "type": "PlayPrompt"
    },
    {
      "id": "368636e5-8e1d-46cb-a342-8a27bf9cd1d6",
      "branches": [
        {
          "condition": "Success",
          "transition": "44b07d2d-7661-4b29-b53d-8733b0175840"
        }
      ],
      "parameters": [
        {
          "name": "LoggingBehavior",
          "value": "Enable"
        }
      ],
      "metadata": {
        "position": {
          "x": 447,
          "y": 19
        }
      },
      "type": "SetLoggingBehavior"
    },
    {
      "id": "6932dec4-7994-4e9b-b1a9-7558aaab8fcb",
      "branches": [
        {
          "condition": "Error",
          "transition": "368636e5-8e1d-46cb-a342-8a27bf9cd1d6"
        },
        {
          "condition": "Success",
          "transition": "368636e5-8e1d-46cb-a342-8a27bf9cd1d6"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "4839de0c-a528-4e74-a12a-f98b8ec0f0e7",
          "key": "BasicQueueId"
        }
      ],
      "metadata": {
        "position": {
          "x": 175,
          "y": 19
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "7910d7ee-d150-40d0-9f90-b4ab56b1e4ec",
      "branches": [
        {
          "condition": "NoMatch",
          "transition": "2d4ba17d-a65c-4195-88c2-13922cb8e370"
        },
        {
          "condition": "CheckQueueTime",
          "transition": "44e68e33-9d16-4f64-82ed-40e5de5cf56d",
          "conditionType": "GreaterThan",
          "conditionValue": "300000"
        },
        {
          "condition": "Error",
          "transition": "45edb1bf-8b4d-40e3-a9f1-85c75f106419"
        }
      ],
      "parameters": [],
      "metadata": {
        "position": {
          "x": 2058,
          "y": 15
        },
        "conditionMetadata": [
          {
            "attribute": {
              "name": "Time in Queue",
              "value": "Time in Queue",
              "internalValue": "CheckQueueTime"
            },
            "time": "min.",
            "value": "5",
            "operator": {
              "name": "Is greater than",
              "value": "GreaterThan",
              "shortDisplay": ">"
            },
            "id": "8a92af46-b4ab-4324-a401-9e9f3c1a5763"
          }
        ],
        "useDynamic": false
      },
      "type": "CheckQueueStatus"
    },
    {
      "id": "13f49ac1-935b-439a-9f2e-cb6d0d2e3985",
      "branches": [
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to set working queue.",
          "key": "error"
        }
      ],
      "metadata": {
        "position": {
          "x": 1844,
          "y": 979
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2",
      "branches": [
        {
          "condition": "Error",
          "transition": "13f49ac1-935b-439a-9f2e-cb6d0d2e3985"
        },
        {
          "condition": "Success",
          "transition": "7910d7ee-d150-40d0-9f90-b4ab56b1e4ec"
        }
      ],
      "parameters": [
        {
          "name": "Queue",
          "value": "BasicQueueId",
          "namespace": "User Defined"
        }
      ],
      "metadata": {
        "position": {
          "x": 1792,
          "y": 14
        },
        "useDynamic": true,
        "queue": "BasicQueueId"
      },
      "type": "SetQueue"
    },
    {
      "id": "43e43416-c441-4293-8f34-870c9caaf759",
      "branches": [
        {
          "condition": "Error",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        },
        {
          "condition": "Success",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Dialed Number",
          "key": "sfdc-ToPhoneNumber",
          "namespace": "System"
        },
        {
          "name": "Attribute",
          "value": "VoiceCall record creation failed.",
          "key": "error"
        }
      ],
      "metadata": {
        "position": {
          "x": 962,
          "y": 269
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "895d32b4-cc3b-4454-88d3-edd237d8856e",
      "branches": [
        {
          "condition": "Error",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        },
        {
          "condition": "Success",
          "transition": "f9aecd5b-639d-44ad-8099-7db1e7bbd8f2"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "voiceCallId",
          "key": "voiceCallId",
          "namespace": "External"
        }
      ],
      "metadata": {
        "position": {
          "x": 1508,
          "y": 17
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "1e829348-68f1-4d5d-a29d-571ff5a92b6b",
      "branches": [
        {
          "condition": "Looping",
          "transition": "031339a0-bdd4-46a0-9c22-188c86fe9b00"
        },
        {
          "condition": "Complete",
          "transition": "43e43416-c441-4293-8f34-870c9caaf759"
        }
      ],
      "parameters": [
        {
          "name": "LoopCount",
          "value": "2"
        }
      ],
      "metadata": {
        "position": {
          "x": 962,
          "y": 17
        },
        "useDynamic": false
      },
      "type": "Loop"
    },
    {
      "id": "031339a0-bdd4-46a0-9c22-188c86fe9b00",
      "branches": [
        {
          "condition": "Error",
          "transition": "1e829348-68f1-4d5d-a29d-571ff5a92b6b"
        },
        {
          "condition": "Success",
          "transition": "895d32b4-cc3b-4454-88d3-edd237d8856e"
        }
      ],
      "parameters": [
        {
          "name": "FunctionArn",
          "value": "arn:aws:lambda:us-west-2:403503132786:function:MigrationTestCC-InvokeTelephonyIntegrationApiFunction:active"
        },
        {
          "name": "TimeLimit",
          "value": "8"
        },
        {
          "name": "Parameter",
          "value": "createVoiceCall",
          "key": "methodName"
        }
      ],
      "metadata": {
        "position": {
          "x": 1235,
          "y": 18
        },
        "dynamicMetadata": {
          "methodName": false
        },
        "useDynamic": false
      },
      "type": "InvokeExternalResource",
      "target": "Lambda"
    },
    {
      "id": "2d4ba17d-a65c-4195-88c2-13922cb8e370",
      "branches": [
        {
          "condition": "Success",
          "transition": "2143f91e-d2fb-4d86-a00a-a678028a8113"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "Transferring to customer support."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 2563,
          "y": 17
        },
        "useDynamic": false
      },
      "type": "PlayPrompt"
    },
    {
      "id": "8872e909-b493-43ba-b592-7cc9e2cfa1b3",
      "branches": [
        {
          "condition": "Error",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        },
        {
          "condition": "Success",
          "transition": "5e054726-0d22-4212-b6f2-d1297973f7ec"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Failed to transfer to queue.",
          "key": "error"
        }
      ],
      "metadata": {
        "position": {
          "x": 3645,
          "y": 348
        }
      },
      "type": "SetAttributes"
    },
    {
      "id": "2143f91e-d2fb-4d86-a00a-a678028a8113",
      "branches": [
        {
          "condition": "Success",
          "transition": "d209b58e-4646-4b4e-b1ed-46aba7803c8e"
        }
      ],
      "parameters": [
        {
          "name": "RecordingBehaviorOption",
          "value": "Enable"
        },
        {
          "name": "RecordingParticipantOption",
          "value": "Both"
        },
        {
          "name": "AnalyticsBehaviorOption",
          "value": "Enable"
        },
        {
          "name": "AnalyticsMode",
          "value": "RealTime"
        },
        {
          "name": "AnalyticsLanguageLocaleCode",
          "value": "en-US"
        },
        {
          "name": "AnalyticsRedactionOption",
          "value": "Enable"
        },
        {
          "name": "AnalyticsRedactionPolicy",
          "value": "RedactedAndOriginal"
        },
        {
          "name": "AnalyticsCustomVocabulary",
          "value": "None"
        }
      ],
      "metadata": {
        "position": {
          "x": 2824,
          "y": 14
        }
      },
      "type": "SetRecordingBehavior"
    },
    {
      "id": "46b57ed3-fc96-49ff-b54c-840db344a958",
      "branches": [
        {
          "condition": "Success",
          "transition": "41bfd902-b5e2-48db-9f0e-a2445665407d"
        }
      ],
      "parameters": [
        {
          "name": "Text",
          "value": "We are experiencing a higher than normal volume of calls and cannot currently assist you. Please try again later. We apologize for any inconvenience. Goodbye."
        },
        {
          "name": "TextToSpeechType",
          "value": "text"
        }
      ],
      "metadata": {
        "position": {
          "x": 3900,
          "y": 16
        },
        "useDynamic": false
      },
      "type": "PlayPrompt"
    },
    {
      "id": "d209b58e-4646-4b4e-b1ed-46aba7803c8e",
      "branches": [
        {
          "condition": "AtCapacity",
          "transition": "0967364c-0fff-403a-812f-106d60881048"
        },
        {
          "condition": "Error",
          "transition": "8872e909-b493-43ba-b592-7cc9e2cfa1b3"
        }
      ],
      "parameters": [],
      "metadata": {
        "position": {
          "x": 3206,
          "y": 8
        },
        "useDynamic": false
      },
      "target": "Queue",
      "type": "Transfer"
    },
    {
      "id": "0967364c-0fff-403a-812f-106d60881048",
      "branches": [
        {
          "condition": "Error",
          "transition": "46b57ed3-fc96-49ff-b54c-840db344a958"
        },
        {
          "condition": "Success",
          "transition": "46b57ed3-fc96-49ff-b54c-840db344a958"
        }
      ],
      "parameters": [
        {
          "name": "Attribute",
          "value": "Queue capacity limit exceeded.",
          "key": "error"
        }
      ],
      "metadata": {
        "position": {
          "x": 3598,
          "y": 4
        }
      },
      "type": "SetAttributes"
    }
  ],
  "metadata": {
    "entryPointPosition": {
      "x": 15,
      "y": 51.5
    },
    "snapToGrid": false,
    "name": "Sample SCV Inbound Flow with Transcription using Contact Lens",
    "description": "Greets the caller and creates a Voice Call record with Contact Lens enabled. Provides a callback option when wait time exceeds five minutes.",
    "type": "contactFlow",
    "status": "published",
    "hash": "e4e81b447ec64767cc74fb0a0337beffe8e3f5c74d2db36501bf04305ebf9efe"
  }
}